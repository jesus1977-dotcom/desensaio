<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Acordes</title>

<style>
/* =========================
   BASE / TEMA
========================= */
:root {
  --bg-main: #141617;
  --bg-card: #1f2426;
  --bg-card-hover: #262b2e;
  --border-soft: #2a2a2a;
  --text-main: #e6e6e6;
  --accent: #1e4d5c;
  --accent-hover: #256273;
  --gold: #f1c27d;
}

body {
  margin: 0;
  padding: 28px;
  background: var(--bg-main);
  color: var(--text-main);
  font-family: Arial, sans-serif;
}

/* =========================
   TOPO
========================= */
.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 18px;
}

h1 {
  margin: 0;
  font-size: 26px;
}

.btn {
  padding: 10px 18px;
  border-radius: 22px;
  background: var(--accent);
  color: #fff;
  font-weight: 700;
  font-size: 13px;
  border: none;
  cursor: pointer;
}

.btn:hover {
  background: var(--accent-hover);
}

/* =========================
   PESQUISA
========================= */
#search {
  width: 100%;
  padding: 14px 18px;
  border-radius: 30px;
  border: none;
  outline: none;
  font-size: 14px;
  margin-bottom: 25px;
}

/* =========================
   GRUPOS
========================= */
.group {
  margin-bottom: 26px;
  background: linear-gradient(180deg, #171a1c, #141617);
  border-radius: 18px;
  padding: 18px;
  border: 1px solid var(--border-soft);
}

.group-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 14px;
}

/* =========================
   CARDS
========================= */
.cards {
  display: flex;
  gap: 14px;
  flex-wrap: wrap;
}

.card {
  background: var(--bg-card);
  border-radius: 16px;
  padding: 14px 16px;
  min-width: 160px;
  box-shadow: inset 0 1px 2px rgba(255,255,255,0.05),
              0 6px 14px rgba(0,0,0,0.6);
  position: relative;
}

.card:hover {
  background: var(--bg-card-hover);
}

.card-name {
  font-weight: 700;
  margin-bottom: 6px;
}

pre {
  margin: 0;
  font-family: monospace;
  font-size: 14px;
  line-height: 1.2;
}

/* ações */
.card-actions {
  position: absolute;
  top: 8px;
  right: 10px;
  display: flex;
  gap: 6px;
}

.card-actions button {
  background: none;
  border: none;
  color: var(--gold);
  cursor: pointer;
  font-size: 12px;
}

/* =========================
   MODAL
========================= */
#modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.75);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999;
}

.modal-box {
  background: #1b1e20;
  padding: 22px;
  border-radius: 18px;
  width: 420px;
  border: 1px solid var(--border-soft);
}

.modal-box h2 {
  margin-top: 0;
}

.modal-box label {
  font-size: 13px;
  color: #aaa;
}

.modal-box input,
.modal-box select {
  width: 100%;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 20px;
  border: none;
  background: #141617;
  color: #fff;
}

.string-inputs {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 6px;
  margin-bottom: 12px;
}

.modal-actions {
  display: flex;
  justify-content: space-between;
}
</style>
</head>

<body>

<div class="top-bar">
  <h1>Acordes</h1>
  <div>
    <button class="btn" onclick="openModal()">+ Inserir acorde</button>
    <button class="btn" onclick="history.back()">Voltar</button>
  </div>
</div>

<input id="search" placeholder="Procurar acorde (ex: maj7, sus, add…)">

<div id="list"></div>

<!-- MODAL -->
<div id="modal">
  <div class="modal-box">
    <h2 id="modalTitle">Novo acorde</h2>

    <label>Nota base</label>
    <select id="root">
      <option>C</option><option>D</option><option>E</option>
      <option>F</option><option>G</option><option>A</option><option>B</option>
    </select>

    <label>Nome do acorde</label>
    <input id="name" placeholder="maj7, m, sus4, add9">

    <label>Tablatura (E A D G B e)</label>
    <div class="string-inputs">
      <input id="s6" placeholder="E">
      <input id="s5" placeholder="A">
      <input id="s4" placeholder="D">
      <input id="s3" placeholder="G">
      <input id="s2" placeholder="B">
      <input id="s1" placeholder="e">
    </div>

    <div class="modal-actions">
      <button class="btn" onclick="closeModal()">Cancelar</button>
      <button class="btn" onclick="saveChord()">Guardar</button>
    </div>
  </div>
</div>

<script>
/* =========================
   DADOS
========================= */
const STORAGE_KEY = 'chords-db';

let chords = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [
  { root:'C', name:'', strings:['x','3','2','0','1','0'] },
  { root:'C', name:'maj7', strings:['x','3','2','0','0','0'] },
  { root:'C', name:'add2', strings:['x','3','2','0','1','0'] },
  { root:'D', name:'', strings:['x','x','0','2','3','2'] },
  { root:'D', name:'sus2', strings:['x','x','0','2','3','0'] },
  { root:'E', name:'', strings:['0','2','2','1','0','0'] },
  { root:'E', name:'sus4', strings:['0','2','2','2','0','0'] },
  { root:'F', name:'', strings:['1','3','3','2','1','1'] },
  { root:'G', name:'', strings:['3','2','0','0','0','3'] }
];

let editingIndex = null;

/* =========================
   RENDER
========================= */
const list = document.getElementById('list');
const search = document.getElementById('search');

function render() {
  list.innerHTML = '';

  const q = search.value.toLowerCase();

  ['C','D','E','F','G','A','B'].forEach(root => {
    const group = chords.filter(c =>
      c.root === root &&
      (c.name + root).toLowerCase().includes(q)
    );
    if (!group.length) return;

    const div = document.createElement('div');
    div.className = 'group';
    div.innerHTML = `<div class="group-title">${root}</div>
                     <div class="cards"></div>`;
    const cards = div.querySelector('.cards');

    group.forEach(c => {
      const idx = chords.indexOf(c);
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <div class="card-actions">
          <button onclick="editChord(${idx})">Editar</button>
          <button onclick="deleteChord(${idx})">Apagar</button>
        </div>
        <div class="card-name">${c.root}${c.name}</div>
        <pre>${formatStrings(c.strings)}</pre>
      `;
      cards.appendChild(card);
    });

    list.appendChild(div);
  });

  localStorage.setItem(STORAGE_KEY, JSON.stringify(chords));
}

function formatStrings(s) {
  return `e|-${s[5]}-
B|-${s[4]}-
G|-${s[3]}-
D|-${s[2]}-
A|-${s[1]}-
E|-${s[0]}-`;
}

/* =========================
   MODAL
========================= */
function openModal() {
  editingIndex = null;
  document.getElementById('modalTitle').innerText = 'Novo acorde';
  document.querySelectorAll('#modal input').forEach(i => i.value = '');
  document.getElementById('modal').style.display = 'flex';
}

function closeModal() {
  document.getElementById('modal').style.display = 'none';
}

function saveChord() {
  const chord = {
    root: root.value,
    name: name.value.trim(),
    strings: [
      s6.value || 'x',
      s5.value || 'x',
      s4.value || 'x',
      s3.value || 'x',
      s2.value || 'x',
      s1.value || 'x'
    ]
  };

  if (editingIndex !== null) {
    chords[editingIndex] = chord;
  } else {
    chords.push(chord);
  }

  closeModal();
  render();
}

function editChord(i) {
  const c = chords[i];
  editingIndex = i;
  modalTitle.innerText = 'Editar acorde';
  root.value = c.root;
  name.value = c.name;
  [s6,s5,s4,s3,s2,s1].forEach((el,idx)=>el.value=c.strings[idx]);
  modal.style.display = 'flex';
}

function deleteChord(i) {
  if (confirm('Apagar este acorde?')) {
    chords.splice(i,1);
    render();
  }
}

search.addEventListener('input', render);

render();
</script>

</body>
</html>
